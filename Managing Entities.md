Objective

After completing this lesson, you will be able to administer entities.

## Management of Entities

Manage the deletion of entities (users or groups) in the target system after they have been deleted from the source system.

#### Scenarios and Solutions

|**Scenario**|**Solution**|
|---|---|
|#### Scenario 1<br><br>An entity exists both in the source and the target system.<br><br>1. You run a provisioning job for the first time.<br>    <br>    As a result, Identity Provisioning reads this entity from the source and updates it on the target system.<br>    <br>2. You delete the relevant entity from the source system.<br>3. You run another provisioning job which finishes successfully.<br>    <br>    However, the service recognizes the relevant entity as a "previously existed one" and does not delete it from the target.|The following sequence of steps is recommended for synchronizing the deletion of entities between source and target systems, as in **Scenarios 1**, **2** and **3**:<br><br>You have run successful provisioning jobs (_Read_ or _Resync_) between the systems.<br><br>1. Delete an entity from the source system.<br>2. On the _Properties_ tab of the target system, add the _ips.delete.existedbefore.entities_ property and set its value to _true_.<br>3. Run a provisioning job.<br>4. Verify that the relevant entity has been deleted from the target system.<br><br>If the property is set **afterward**, entities recognized as "previously existed ones" cannot be deleted from the target system anymore. In this case, you must delete them from the target system (for example, manually or through a script).<br><br>The _ips.delete.existedbefore.entities_ is an optional property that can be set on every target system. You can use it to control whether recognized entities as "previously existed ones" should be deleted from the target system.<br><br>This is important for security and legal reasons in cases when users (for example, employees) are no longer active in the source system, and their availability and permissions must be removed from the relevant target systems.|
|#### Scenario 2<br><br>An entity does not exist in either system (neither source, or target).<br><br>1. You run provisioning jobs (_Read_ or _Resync_) between the systems.<br>2. You add this entity to the source system.<br>3. The same entity is added (manually or through script) to the target system.<br>4. You run a new provisioning job.<br>    <br>    As a result, Identity Provisioning reads this entity from the source and updates it in the target system.<br>    <br>5. You delete the relevant entity from the source system.<br>6. You run another provisioning job which finishes successfully.<br>    <br>    However, the service recognizes the relevant entity as a "previously existed one" and **does not delete** it from the target.|
|#### Scenario 3<br><br>An entity exists in the source system only.<br><br>1. You run at least one provisioning job.<br>    <br>    As a result, Identity Provisioning reads this entity and creates it in the target system.<br>    <br>2. You reset one of these systems.<br>3. You run a new provisioning job.<br>    <br>    As a result, Identity Provisioning reads this entity from the source system (but is not "aware" of it, that is, it behaves like it is reading it for the first time) and makes a full update of it in the target system.<br>    <br>4. You delete the relevant entity from the source system.<br>5. You run another provisioning job which finishes successfully.<br>    <br>    However, the service recognizes the relevant entity as a "previously existed one" and **does not delete** it from the target.|
|#### Scenario 4<br><br>An entity exists both in the source and the target system. (It has **not** been created on the target by the Identity Provisioning service.)<br><br>Conditions or expressions, such as (ignore or _skipOperations_), are not set in the target transformation.<br><br>1. You run a successful **Read** job. As a result, Identity Provisioning updates the existing entity on the target system.<br>2. You delete this entity from the source system.<br>3. You run a provisioning job which finishes with error.<br>    <br>    As a result, the relevant entity has not been deleted from the target system.<br>    <br>4. In the job log, you see that there are failed entities (users or groups) on the source system. That means that the job has failed trying to read them from the source.|1. Resolve the failed entities in the source system.<br>2. On the _Properties_ tab of the target system, add the _ips.delete.existedbefore.entities_ property and set its value to **true**.<br>3. Run a successful **Read** job between the systems.<br>4. Verify that the relevant entity has been deleted from the target system.<br>    <br>    Note<br>    <br>    Even if the job fails due to errors on the target system, if the read from the source is successful, the service will still delete the entity from the target.|
|#### Scenario 5<br><br>An entity exists in the source system and has been provisioned to the target by the Identity Provisioning service.<br><br>Conditions or expressions, such as (ignore or _skipOperations_), are not set in the target transformation.<br><br>1. You delete this entity from the source system.<br>2. You run a provisioning job which finishes with error.<br>    <br>    As a result, the relevant entity has not been deleted from the target system.<br>    <br>3. In the job log, you see that there are failed entities (users or groups) on the source system. This means that the job has failed trying to read them from the source.|1. Resolve the failed entities in the source system.<br>2. Run a successful **Read** job between the systems.<br>3. Verify that the relevant entity has been deleted from the target system.<br>    <br>    Note<br>    <br>    Even if the job fails due to errors on the target system, if the read from the source is successful, the service will still delete the entity from the target.|
|#### Scenario 6<br><br>An entity exists in the source system and has been provisioned to the target by the Identity Provisioning service.<br><br>Conditions or expressions, such as (_ignore_ or _skipOperations_), are not set in the target transformation.<br><br>1. You delete an entity from the source system.<br>2. You run a **delta read** job which finishes successfully.<br>    <br>    However, the relevant entry has not been deleted from the target system. That is because _delta read_ jobs do not take deleted users into consideration. ).|1. On the _Properties_ tab of the source system, set the ips.delta.read property to _false_.<br>    <br>    Alternatively, you can wait for the next scheduled _full job_ to start (if it is coming soon), according to the number you have set for property ips.full.read.force.count.<br>    <br>2. Run a new provisioning job (or wait for it to run automatically). It will be a _full read_ job.<br>3. Verify that the relevant entity has been deleted from the target system.<br>4. (Optional) If you want to continue running _delta read_ jobs, go to the ips.delta.read property and set it back to **true**.|